<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ahk to js</title>
    <style>
      body {
        background-color: #202020;
        font-family:
          "Open Sans",
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          Roboto,
          Oxygen-Sans,
          Ubuntu,
          Cantarell,
          "Helvetica Neue",
          Helvetica,
          Arial,
          sans-serif;
      }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11" rel="stylesheet" />
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      // JavaScript equivalent code with variables

      function showCustomMessageBox(options, title, text, value, timeout) {
        return new Promise((resolve) => {
          // Define default options for the message box
          let defaultOptions = {
            title: title || "", // Default title is empty
            text: text || "Press OK to continue.", // Default text if not provided
            showCancelButton: false, // Default is to not show Cancel button
            showDenyButton: false, // Default is to not show Deny button
            confirmButtonText: "OK", // Default text for OK button
            focusConfirm: true, // Default focus on OK button
          };

          let numOriginal = value;

          let num = numOriginal;

          let done1 = 0;

          let done2 = 0;

          let done3 = 0;

          let AIndex = 0;

          for (AIndex = 1; AIndex <= 1; AIndex++) {
            // this is about if you add always on top in a msgbox it will be removed in js cuz its kinda useless...
            // becouse if you like adding always on top in ahk in js we dont realy do it so yeah
            if (num >= 262144) {
              num = num - 262144;
              numOriginal = numOriginal - 262144;
            }

            if (num >= 256 && num < 500) {
              num = num - 256;

              done3 = 256;
            }

            if (num >= 512) {
              num = num - 512;

              done3 = 512;
            }

            if (num == 0) {
              done1 = 0;

              break;
            }

            if (num <= 6) {
              done1 = num;

              break;
            }

            if (num >= 64 && num < 64 * 2) {
              done2 = 64;

              if (num == 64) {
                done1 = 0;

                break;
              } else {
                done1 = num - 64;

                break;
              }
            }

            if (num >= 48 && num < 63) {
              done2 = 48;

              if (num == 48) {
                done1 = 0;

                break;
              } else {
                done1 = num - 48;

                break;
              }
            }

            if (num >= 32 && num < 47) {
              done2 = 32;

              if (num == 32) {
                done1 = 0;

                break;
              } else {
                done1 = num - 32;

                break;
              }
            }

            if (num >= 16 && num < 30) {
              done2 = 16;

              if (num == 16) {
                done1 = 0;

                break;
              } else {
                done1 = num - 16;

                break;
              }
            }
          }

          let doneAdded = done1 + done2 + done3;

          if (doneAdded !== numOriginal) {
            // displayMessage("The calc was wrong!");
          } else {
            // displayMessage("num was: " + numOriginal + "\ndone1: " + done1 + "\ndone2: " + done2 + "\ndone3: " + done3);
          }

          // Parse the value to determine the options for the message box
          if (done1 === 1) defaultOptions.showCancelButton = true; // OK/Cancel in ahk but here it will show Ok/Cancel wiat its same haha

          // not gonna work if you can make it work i will appreciate
          //   if (done1 === 2) {
          //     defaultOptions.showCancelButton = true; // Abort/Retry/Ignore
          //     defaultOptions.showDenyButton = true;
          //   }
          if (done1 === 3) {
            defaultOptions.showCancelButton = true; // Yes/No/Cancel in ahk but here it will show Ok/No/Cancel
            defaultOptions.showDenyButton = true;
          }
          if (done1 === 4) {
            // defaultOptions.showCancelButton = true;
            defaultOptions.showDenyButton = true; // Yes/No in ahk but here it will show Ok/No
          }
          if (done1 === 5) {
            defaultOptions.showCancelButton = true; // Retry/Cancel in ahk but here it will show Ok/Cancel tip you can write in the Msgbox press ok to retry
          }
          // not gonna work if you can make it work i will appreciate
          //   if (done1 === 6) {
          //     defaultOptions.showCancelButton = true; // Cancel/Try Again/Continue
          //     defaultOptions.showDenyButton = true;
          //   }

          if (done2 === 16) defaultOptions.icon = "error"; // Icon Hand (stop/error)
          if (done2 === 32) defaultOptions.icon = "question"; // Icon Question
          if (done2 === 48) defaultOptions.icon = "warning"; // Icon Exclamation
          if (done2 === 64) defaultOptions.icon = "info"; // Icon Asterisk (info)

          if (done3 === 256) defaultOptions.focusDeny = true; // Makes the 3rd button the default
          if (done3 === 512) defaultOptions.focusCancel = true; // Makes the 2nd button the default

          // Set timeout if provided
          if (timeout) {
            defaultOptions.timer = timeout * 1000; // Convert timeout to milliseconds
          }

          // Merge default options with provided options
          Object.assign(defaultOptions, options);

          // Display the message box with the constructed options
          Swal.fire(defaultOptions).then((result) => {
            if (result.isConfirmed) {
              resolve("OK");
            } else if (result.isDenied) {
              resolve("No");
            } else {
              resolve("Cancel");
            }
          });
        });
      }

      let lastInputTime = Date.now(); // Initialize with current timestamp
      let startTimestamp = Date.now(); // Initialize with current timestamp

      // Event listener to track user activity
      function resetIdleTimer() {
        lastInputTime = Date.now(); // Update last input time
      }

      document.addEventListener("mousemove", resetIdleTimer);
      document.addEventListener("keypress", resetIdleTimer);

      // Function to calculate time since last input event
      function A_TimeIdle() {
        return Date.now() - lastInputTime; // Calculate time difference
      }

      // Function to calculate tick count in milliseconds
      function A_TickCount() {
        return Date.now() - startTimestamp;
      }

      function BuildInVars(varName) {
        switch (varName) {
          case "A_ScreenWidth":
            // Return screen width
            return window.innerWidth;
          case "A_ScreenHeight":
            // Return screen height
            return window.innerHeight;
          case "A_TimeIdle":
            // Return time idle
            return A_TimeIdle();
          case "A_TickCount":
            // Return tick count in milliseconds
            return A_TickCount();
          case "A_NowUTC":
            // Return current UTC timestamp
            return new Date().toISOString();
          case "A_Now":
            // Return current local timestamp
            return new Date().toLocaleString();
          case "A_YYYY":
            // Return current year
            return new Date().getFullYear();
          case "A_MM":
            // Return current month
            return (new Date().getMonth() + 1).toString().padStart(2, "0");
          case "A_DD":
            // Return current day
            return new Date().getDate().toString().padStart(2, "0");
          case "A_MMMM":
            // Return full month name
            return new Date().toLocaleDateString(undefined, { month: "long" });
          case "A_MMM":
            // Return short month name
            return new Date().toLocaleDateString(undefined, { month: "short" });
          case "A_DDDD":
            // Return full day name
            return new Date().toLocaleDateString(undefined, { weekday: "long" });
          case "A_DDD":
            // Return short day name
            return new Date().toLocaleDateString(undefined, { weekday: "short" });
          case "A_Hour":
            // Return current hour
            return new Date().getHours().toString().padStart(2, "0");
          case "A_Min":
            // Return current minute
            return new Date().getMinutes().toString().padStart(2, "0");
          case "A_Sec":
            // Return current second
            return new Date().getSeconds().toString().padStart(2, "0");
          case "A_Space":
            // Return space character
            return " ";
          case "A_Tab":
            // Return tab character
            return "\t";

          default:
            // Handle unknown variable names
            return null;
        }
      }

      // Absolute value
      function Abs(num) {
        if (num === null || isNaN(num)) return null;
        return Math.abs(num);
      }

      // Arc cosine
      function ACos(num) {
        if (num === null || isNaN(num)) return null;
        return Math.acos(num);
      }

      // Arc sine
      function ASin(num) {
        if (num === null || isNaN(num)) return null;
        return Math.asin(num);
      }

      // Arc tangent
      function ATan(num) {
        if (num === null || isNaN(num)) return null;
        return Math.atan(num);
      }

      // Ceiling
      function Ceil(num) {
        if (num === null || isNaN(num)) return null;
        return Math.ceil(num);
      }

      // Cosine
      function Cos(num) {
        if (num === null || isNaN(num)) return null;
        return Math.cos(num);
      }

      // Exponential
      function Exp(num) {
        if (num === null || isNaN(num)) return null;
        return Math.exp(num);
      }

      // Flooring
      function Floor(num) {
        if (num === null || isNaN(num)) return null;
        return Math.floor(num);
      }

      // Natural logarithm
      function Ln(num) {
        if (num === null || isNaN(num)) return null;
        return Math.log(num);
      }

      // Base-10 logarithm
      function Log(num) {
        if (num === null || isNaN(num)) return null;
        return Math.log10(num);
      }

      // Rounding
      function Round(num) {
        if (num === null || isNaN(num)) return null;
        return Math.round(num);
      }

      // Sine
      function Sin(num) {
        if (num === null || isNaN(num)) return null;
        return Math.sin(num);
      }

      // Square root
      function Sqrt(num) {
        if (num === null || isNaN(num)) return null;
        return Math.sqrt(num);
      }

      // Tangent
      function Tan(num) {
        if (num === null || isNaN(num)) return null;
        return Math.tan(num);
      }

      function Chr(number) {
        // Check if the number is null
        if (number === null) {
          // Return an empty string
          return "";
        }

        // Check if the number is within the valid range
        if (number >= 0 && number <= 0x10ffff) {
          // Convert the number to a character using String.fromCharCode
          return String.fromCharCode(number);
        } else {
          // Return an empty string for invalid numbers
          return "";
        }
      }

      // Function to simulate Sleep
      function sleep(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms));
      }

      // InStr
      function InStr(Haystack, Needle, CaseSensitive = true, StartingPos = 1, Occurrence = 1) {
        if (Haystack === null || Needle === null) return null;

        // Adjust starting position if less than 1
        StartingPos = Math.max(StartingPos, 1);

        // Case-sensitive search by default
        if (!CaseSensitive) {
          Haystack = Haystack.toLowerCase();
          Needle = Needle.toLowerCase();
        }

        let pos = -1;
        let count = 0;
        for (let i = StartingPos - 1; i < Haystack.length; i++) {
          if (Haystack.substring(i, i + Needle.length) === Needle) {
            count++;
            if (count === Occurrence) {
              pos = i + 1;
              break;
            }
          }
        }

        return pos;
      }

      // RegExMatch
      function RegExMatch(Haystack, NeedleRegEx, OutputVar, StartingPos) {
        if (Haystack === null || NeedleRegEx === null) return null;

        const regex = new RegExp(NeedleRegEx);
        const match = Haystack.match(regex);

        if (match) {
          if (OutputVar) {
            OutputVar.push(match[0]);
          }
          return match.index + 1;
        } else {
          return 0;
        }
      }

      // RegExReplace

      // RegExReplace
      function RegExReplace(Haystack, NeedleRegEx, Replacement, OutputVarCount, Limit, StartingPos) {
        if (Haystack === null || NeedleRegEx === null || Replacement === null) return null;

        const regex = new RegExp(NeedleRegEx, "g");
        let count = 0;
        const result = Haystack.replace(regex, (match) => {
          if (count < Limit || Limit === 0) {
            count++;
            return Replacement;
          } else {
            return match;
          }
        });

        if (OutputVarCount) {
          OutputVarCount.push(count);
        }

        return result;
      }

      // StrLen
      function StrLen(str) {
        return str === null ? null : str.length;
      }

      // StrSplit function
      async function StrSplit(String, Delimiters, OmitChars, MaxParts) {
        if (String === null || Delimiters === null) return null;

        const regex = new RegExp(`[${Delimiters}${OmitChars}]`, "g");
        const parts = String.split(regex, MaxParts).map((part) => part.trim());

        return parts;
      }

      // Format (simplified version)
      function Format(formatString, ...values) {
        return formatString.replace(/{(\d+)}/g, (match, index) => (values[index] !== undefined ? values[index] : match));
      }

      // Ord
      function Ord(str) {
        return str === null ? null : str.charCodeAt(0);
      }

      // Function to generate a random number between min (inclusive) and max (inclusive)
      function getRandomNumber(min, max) {
        return Math.floor(Math.random() * (max - min + 1) + min);
      }

      function SubStr(inputString, startingPos, length) {
        if (inputString === null) {
          return "";
        }

        if (startingPos < 1) {
          // Calculate starting position from the end of the string
          startingPos = inputString.length + startingPos;
        }

        // Adjust starting position if it's beyond the string's length
        if (startingPos > inputString.length) {
          return "";
        }

        // Handle negative length to omit characters from the end
        if (length < 0) {
          length = inputString.length + length - startingPos;
        }

        // Return the requested substring
        return inputString.substring(startingPos - 1, startingPos - 1 + length);
      }

      function Trim(inputString) {
        // Check if inputString is null or undefined
        if (inputString == null) {
          return ""; // Return an empty string if inputString is null or undefined
        }
        return inputString.replace(/^\s+|\s+$/g, ""); // Removes leading and trailing whitespace
      }

      function StrReplace(originalString, find, replaceWith) {
        // Check if originalString is a string
        if (typeof originalString !== "string") {
          return originalString; // Return originalString as is
        }
        // Use replace method to replace find with replaceWith
        return originalString.replace(new RegExp(find, "g"), replaceWith);
      }

      // Custom Mod function
      function Mod(dividend, divisor) {
        return dividend % divisor;
      }

      function Asc(char) {
        return char.charCodeAt(0);
      }

      // Function to trim specified number of characters from the left side of a string
      function StringTrimLeft(input, numChars) {
        if (input && input.length >= numChars) {
          return input.substring(numChars);
        } else {
          console.error("Invalid input provided.");
          return input; // Return original input if trimming is not possible
        }
      }

      // Function to trim specified number of characters from the right side of a string
      function StringTrimRight(input, numChars) {
        if (input && input.length >= numChars) {
          return input.substring(0, input.length - numChars);
        } else {
          console.error("Invalid input provided.");
          return input; // Return original input if trimming is not possible
        }
      }

      // Function to display a message
      function displayMessage(message) {
        return new Promise((resolve) => {
          alert(message);
          resolve();
        });
      }

      function GuiControl(action, id, param1, param2, param3, param4) {
        const element = document.getElementById(id);
        if (element) {
          if (action === "move") {
            // Set position and size
            element.style.left = param1 + "px";
            element.style.top = param2 + "px";
            element.style.width = param3 + "px";
            element.style.height = param4 + "px";
          } else if (action === "focus" && (element instanceof HTMLInputElement || element instanceof HTMLElement)) {
            // Focus on the element
            element.focus();
          } else if (action === "text") {
            // Set new text content
            element.textContent = param1;
          } else if (action === "hide") {
            // Hide the element
            element.style.display = "none";
          } else if (action === "show") {
            // Show the element
            element.style.display = "";
          } else if (action === "enable") {
            // Enable the element
            element.disabled = false;
          } else if (action === "disable") {
            // Disable the element
            element.disabled = true;
          } else if (action === "font") {
            // Set font size
            element.style.fontSize = param1 + "px";
          } else if (action === "color") {
            // Set color
            element.style.color = param1;
          }
        }
      }

      // Object to store timer intervals for different functions
      const timerIntervals = {};

      async function SetTimer(func, timeOrOnOff) {
        if (typeof func !== "function" || typeof timeOrOnOff === "undefined") {
          console.error("Invalid arguments. Please provide a valid function and time/On/Off state.");
          return;
        }

        if (typeof timeOrOnOff === "number") {
          // If a number is provided, set the timer to that time in milliseconds and start it.
          func.interval = timeOrOnOff; // Store the interval within the function
          func(); // Call the function initially
          func.intervalId = setInterval(func, timeOrOnOff);
          timerIntervals[func] = func.intervalId; // Store the interval ID
        } else if (timeOrOnOff === "On") {
          // If 'On' is provided, start the timer if it's not already running.
          if (!func.intervalId && func.interval) {
            func(); // Call the function initially
            func.intervalId = setInterval(func, func.interval); // Start with the stored interval
            timerIntervals[func] = func.intervalId; // Store the interval ID
          } else {
            console.error("Timer is not set. Please provide a valid interval.");
          }
        } else if (timeOrOnOff === "Off") {
          // If 'Off' is provided, clear the timer if it's running.
          clearInterval(func.intervalId);
          func.intervalId = null;
          delete timerIntervals[func]; // Remove the interval ID from storage
        } else {
          console.error("Invalid time/On/Off state. Please provide a valid time in milliseconds or 'On'/'Off'.");
        }
      }

      function FileAppend(data, filename) {
        // Create a blob with the provided data
        const blob = new Blob([data], { type: "text/plain" });

        // Create a temporary anchor element
        const anchor = document.createElement("a");
        anchor.style.display = "none";

        // Set the download attribute and filename
        anchor.setAttribute("href", window.URL.createObjectURL(blob));
        anchor.setAttribute("download", filename);

        // Append the anchor element to the body
        document.body.appendChild(anchor);

        // Trigger a click event on the anchor element
        anchor.click();

        // Remove the anchor element
        document.body.removeChild(anchor);
      }

      // Single async function to structure the entire script
      async function runScript() {
        // Declare and assign a variable
        let variables = {
          A_Index: null,
          A_IsTranspiled: 1,
          A_LoopField: null,
          AHour: null,
          ampm: null,
          characters: null,
          ElapsedTime123: null,
          ElapsedTime: null,
          EndTime: null,
          fileAPPP: null,
          h: null,
          hours: null,
          isRunning: null,
          milliseconds: null,
          minutes: null,
          ms: null,
          OutputVar: null,
          seconds: null,
          StartTime: null,
          StartTimee: null,
          storeElapsedTime: null,

          w: null,
        };

        let funcs = {};

        let Gui1 = {};
        Gui1 = document.createElement("div");

        //
        //
        // Name:
        // Projects time tracker AHK
        //
        //
        // A lightweight AutoHotkey script to track the time spent on your projects.
        //
        //

        variables.storeElapsedTime = 0;

        if (variables.A_IsTranspiled == "") {
          // do something if its transpiled
        } else {
          // do something if its not transpiled
        }

        Gui1Static1 = document.createElement("div");
        Gui1Static1.id = "Gui1Static1"; // Set ID for referencing
        Gui1Static1.textContent = "Track your time for a project";
        Gui1Static1.style.color = "#white";
        Gui1Static1.style.fontSize = "23px"; // Set font size
        Gui1Static1.style.position = "absolute"; // Set position to absolute
        Gui1Static1.style.left = "0px"; // Set initial x position
        Gui1Static1.style.top = "10px"; // Set initial y position
        Gui1Static1.style.width = "1000px"; // Set width
        Gui1Static1.style.height = "30px"; // Set height
        Gui1.appendChild(Gui1Static1);

        Gui1TextSelectedFolder = document.createElement("div");
        Gui1TextSelectedFolder.id = "Gui1" + "TextSelectedFolder"; // Set ID for referencing
        Gui1TextSelectedFolder.textContent = "";
        Gui1TextSelectedFolder.style.color = "#white";
        Gui1TextSelectedFolder.style.fontSize = "23px"; // Set font size
        Gui1TextSelectedFolder.style.position = "absolute"; // Set position to absolute
        Gui1TextSelectedFolder.style.left = "10px"; // Set initial x position
        Gui1TextSelectedFolder.style.top = "550px"; // Set initial y position
        Gui1TextSelectedFolder.style.width = "1000px"; // Set width
        Gui1TextSelectedFolder.style.height = "100px"; // Set height
        Gui1.appendChild(Gui1TextSelectedFolder);

        if (variables.A_IsTranspiled == "") {
          // do something if its transpiled
        } else {
          // do something if its not transpiled
        }

        Gui1Start = document.createElement("button");
        Gui1Start.id = "Gui1" + "Start"; // Set ID for referencing
        Gui1Start.textContent = "Start/Resume";
        Gui1Start.style.fontSize = "20px"; // Set font size
        Gui1Start.style.position = "absolute"; // Set position to absolute
        Gui1Start.style.left = "10px"; // Set initial x position
        Gui1Start.style.top = "150px"; // Set initial y position
        Gui1Start.style.width = "150px"; // Set width
        Gui1Start.style.height = "50px"; // Set height
        Gui1Start.onclick = function (event) {
          A_GuiControl = event.target.id.replace(/^Gui\d*/, "");
          Start(A_GuiControl);
        };
        Gui1.appendChild(Gui1Start);

        if (variables.A_IsTranspiled == "") {
          // do something if its not transpiled
        } else {
          // do something if its transpiled
        }

        Gui1Stop = document.createElement("button");
        Gui1Stop.id = "Gui1" + "Stop"; // Set ID for referencing
        Gui1Stop.textContent = "Stop/Pause";
        Gui1Stop.style.fontSize = "23px"; // Set font size
        Gui1Stop.style.position = "absolute"; // Set position to absolute
        Gui1Stop.style.left = "10px"; // Set initial x position
        Gui1Stop.style.top = "210px"; // Set initial y position
        Gui1Stop.style.width = "150px"; // Set width
        Gui1Stop.style.height = "50px"; // Set height
        Gui1Stop.onclick = function (event) {
          A_GuiControl = event.target.id.replace(/^Gui\d*/, "");
          Stop(A_GuiControl);
        };
        Gui1.appendChild(Gui1Stop);

        Gui1Reset = document.createElement("button");
        Gui1Reset.id = "Gui1" + "Reset"; // Set ID for referencing
        Gui1Reset.textContent = "Reset";
        Gui1Reset.style.fontSize = "23px"; // Set font size
        Gui1Reset.style.position = "absolute"; // Set position to absolute
        Gui1Reset.style.left = "10px"; // Set initial x position
        Gui1Reset.style.top = "270px"; // Set initial y position
        Gui1Reset.style.width = "150px"; // Set width
        Gui1Reset.style.height = "50px"; // Set height
        Gui1Reset.onclick = function (event) {
          A_GuiControl = event.target.id.replace(/^Gui\d*/, "");
          Reset(A_GuiControl);
        };
        Gui1.appendChild(Gui1Reset);

        Gui1Time = document.createElement("div");
        Gui1Time.id = "Gui1" + "Time"; // Set ID for referencing
        Gui1Time.textContent = "";
        Gui1Time.style.color = "#white";
        Gui1Time.style.fontSize = "23px"; // Set font size
        Gui1Time.style.position = "absolute"; // Set position to absolute
        Gui1Time.style.left = "10px"; // Set initial x position
        Gui1Time.style.top = "350px"; // Set initial y position
        Gui1Time.style.width = "350px"; // Set width
        Gui1Time.style.height = "50px"; // Set height
        Gui1.appendChild(Gui1Time);

        Gui1Save = document.createElement("button");
        Gui1Save.id = "Gui1" + "Save"; // Set ID for referencing
        Gui1Save.textContent = "Save";
        Gui1Save.style.fontSize = "23px"; // Set font size
        Gui1Save.style.position = "absolute"; // Set position to absolute
        Gui1Save.style.left = "10px"; // Set initial x position
        Gui1Save.style.top = "410px"; // Set initial y position
        Gui1Save.style.width = "150px"; // Set width
        Gui1Save.style.height = "50px"; // Set height
        Gui1Save.onclick = function (event) {
          A_GuiControl = event.target.id.replace(/^Gui\d*/, "");
          Save(A_GuiControl);
        };
        Gui1.appendChild(Gui1Save);

        GuiControl("hide", "Gui1Start");
        GuiControl("hide", "Gui1Stop");
        GuiControl("hide", "Gui1Save");
        GuiControl("hide", "Gui1Reset");

        GuiControl("disable", "Gui1Stop");
        GuiControl("disable", "Gui1Save");
        GuiControl("disable", "Gui1Start");
        variables.h = BuildInVars("A_ScreenHeight") - 100;

        variables.w = BuildInVars("A_ScreenWidth") - 100;

        Gui1.style.position = "absolute";
        Gui1.style.width = "" + variables.w + "px"; // Set the width
        Gui1.style.height = "" + variables.h + "px"; // Set the height
        Gui1.style.backgroundColor = "#121212";
        Gui1.style.color = "white";
        Gui1.style.fontSize = "15px";
        Gui1.style.padding = "10px";
        Gui1.style.border = "2px solid white";

        // Calculate center position
        Gui1.style.left = (window.innerWidth - parseInt(Gui1.style.width)) / 2 + "px";
        Gui1.style.top = (window.innerHeight - parseInt(Gui1.style.height)) / 2 + "px";

        document.body.appendChild(Gui1); // Append the GUI window to the body

        await Button();
        return;

        async function Button(A_GuiControl) {
          // await showCustomMessageBox({}," ", "You selected folder \" + variables.OutputVar + \". ", 0, 0)
          variables.OutputVar = "Project Time.txt";

          GuiControl("text", "Gui1TextSelectedFolder", "You're selected text is Project Time.txt");
          GuiControl("show", "Gui1Start");
          GuiControl("show", "Gui1Stop");
          GuiControl("show", "Gui1Reset");
          GuiControl("disable", "Gui1Reset");

          GuiControl("disable", "Gui1Stop");
          GuiControl("enable", "Gui1Start");
        }

        async function Save(A_GuiControl) {
          variables.isRunning = 1;

          GuiControl("disable", "Gui1Stop");
          GuiControl("disable", "Gui1Save");
          variables.fileAPPP = "The duration of that session between " + variables.StartTimee + " and " + variables.EndTime + " is " + variables.ElapsedTime123 + "\n";

          FileAppend(variables.fileAPPP, "Project Time.txt");
          await showCustomMessageBox({}, " ", variables.fileAPPP + "Project Time.txt", 0, 0);
          await Reset();
        }

        async function Start(A_GuiControl) {
          if (variables.isRunning !== 1) {
            variables.StartTime = BuildInVars("A_TickCount");

            if (BuildInVars("A_Hour") >= 13) {
              variables.AHour = BuildInVars("A_Hour") - 12;

              variables.ampm = "PM";
            } else {
              variables.AHour = BuildInVars("A_Hour");

              variables.ampm = "AM";
            }
            variables.StartTimee = variables.AHour + ":" + BuildInVars("A_Min") + " " + variables.ampm;
          }
          variables.StartTime = BuildInVars("A_TickCount") - variables.storeElapsedTime;

          variables.isRunning = 1;

          GuiControl("enable", "Gui1Stop");
          GuiControl("disable", "Gui1Start");
          GuiControl("disable", "Gui1Save");
          GuiControl("disable", "Gui1Reset");
          SetTimer(Time, 1);
        }

        async function Stop(A_GuiControl) {
          variables.isRunning = 1;

          GuiControl("enable", "Gui1Start");
          GuiControl("enable", "Gui1Reset");
          GuiControl("disable", "Gui1Stop");
          GuiControl("show", "Gui1Save");
          GuiControl("enable", "Gui1Save");

          SetTimer(Time, "Off");
          variables.storeElapsedTime = BuildInVars("A_TickCount") - variables.StartTime;

          variables.ElapsedTime = BuildInVars("A_TickCount") - variables.StartTime;

          if (BuildInVars("A_Hour") >= 13) {
            variables.AHour = BuildInVars("A_Hour") - 12;

            variables.ampm = "PM";
          } else {
            variables.AHour = BuildInVars("A_Hour");

            variables.ampm = "AM";
          }
          variables.EndTime = variables.AHour + ":" + BuildInVars("A_Min") + " " + variables.ampm;

          variables.ms = variables.ElapsedTime;

          // Calculate the components
          variables.hours = Math.floor(variables.ms / 3600000);

          variables.ms = Mod(variables.ms, 3600000);

          variables.minutes = Math.floor(variables.ms / 60000);

          variables.ms = Mod(variables.ms, 60000);

          variables.seconds = Math.floor(variables.ms / 1000);

          variables.milliseconds = Mod(variables.ms, 1000);

          // Display the result
          variables.ElapsedTime123 = "";

          variables.ElapsedTime123 += variables.hours + " hours " + variables.minutes + " minutes " + variables.seconds + " seconds and " + variables.milliseconds + " ms.";
        }

        async function Reset(A_GuiControl) {
          variables.isRunning = 0;

          variables.storeElapsedTime = 0;

          GuiControl("enable", "Gui1Start");
          GuiControl("disable", "Gui1Stop");
          SetTimer(Time, "Off");
          variables.milliseconds = 0;

          variables.seconds = 0;

          variables.minutes = 0;

          variables.hours = 0;

          variables.ElapsedTime123 = variables.hours + "h " + variables.minutes + "m " + variables.seconds + "s " + variables.milliseconds + "ms";

          GuiControl("text", "Gui1Time", variables.ElapsedTime123);
        }

        async function Time(A_GuiControl) {
          variables.ElapsedTime = BuildInVars("A_TickCount") - variables.StartTime;

          variables.ms = variables.ElapsedTime;

          // Calculate the components
          variables.hours = Math.floor(variables.ms / 3600000);

          variables.ms = Mod(variables.ms, 3600000);

          variables.minutes = Math.floor(variables.ms / 60000);

          variables.ms = Mod(variables.ms, 60000);

          variables.seconds = Math.floor(variables.ms / 1000);

          variables.milliseconds = Mod(variables.ms, 1000);

          // Display the result
          variables.ElapsedTime123 = "";

          variables.ElapsedTime123 = variables.hours + "h " + variables.minutes + "m " + variables.seconds + "s " + variables.milliseconds + "ms";

          GuiControl("text", "Gui1Time", variables.ElapsedTime123);
        }

        async function GuiClose(A_GuiControl) {
          if (variables.isRunning == 1) {
            await Stop();
            await sleep(100);
            await Save();
            await sleep(100);
          }
          window.close();
        }
      }

      // Call the async function to start the script
      runScript();
    </script>
  </body>
</html>
